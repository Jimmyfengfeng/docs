---
title: 鉴权
description: 鉴权和加密说明
---

## 加密方式说明

- 签名算法: RSA
- 秘钥长度: 1024 位
- 签名方式: SHA1WithRSA

说明: 商户接入需先生成商户公钥, 开通商户时生成平台公钥(交换公钥), 平台公钥会发送到商户绑定邮箱,
商户和平台使用各自的平台私钥进行加签, 各自使用对方公钥进行验签

## 请求头验证&签名规则

1. 请求头中必须包含 nonce 和 timestamp
2. timestamp 如果商户发送当前时间戳和当前平台时间超过 30S, 则认为此请求已过期
3. 生成随机字符串 nonce, 24 小时内不能重复
4. 请求体字段名按照 ASCII 进行升序排序, 拼接为 a=1&b=2, 只对有值字段进行排序
5. 对排序结果后增加 nonce=123, 排序后为 a=1&b=2&nonce=123
6. 使用私钥对 a=1&b=2&nonce=123 进行加签, 放入请求体中 sign 字段
7. 平台收到请求后会对 timestamp, nonce 和 sign 进行验签, 验证失败直接返回失败

平台回调商户会进行以上操作, 建议商户对参数进行加签

## 请求格式

不同接口请求参数不同,但所有请求参数中都应含有 sign 字段

## 响应格式

import Table from "@components/Table.astro";

<Table
  thead={["字段", "类型", "必需", "描述"]}
  tbody={[
    ["code", "int", "是", "状态码"],
    ["msg", "string", "是", "返回信息"],
    ["data", "object", "否", "返回数据"],
  ]}
/>
